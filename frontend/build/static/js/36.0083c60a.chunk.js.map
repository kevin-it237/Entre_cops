{"version":3,"sources":["../node_modules/encoding/lib sync","ui/components/CouponSchema/Coupon.js","ui/admin/AdminCoupons/AdminCoupons.js"],"names":["webpackEmptyContext","req","e","Error","code","keys","resolve","module","exports","id","counponToPrint","logoBase64","infos","montant","datelimite","title","qr","filename","defaultFileName","pageSize","width","height","fillColor","pageMargins","content","image","style","alignment","lineHeight","text","fontSize","bold","color","italics","pdfMake","vfs","pdfFonts","image2base64","require","AdminCoupons","state","showModal","error","loading","selectedAnnonce","eventType","event","events","eventsLoading","services","service","servicesLoading","nCoupons","couponValid","couponError","removing","handleInputChange","preventDefault","name","target","value","_this","setState","Object","defineProperty","validate","_this$state","trim","length","openModal","type","url","axios","get","then","res","data","catch","err","generateCoupon","_this$state2","clients","coupons","toConsumableArray","coupon","rootUrl","patch","_id","newEvents","filter","logo","response","docDefinition","split","join","createPdf","open","console","log","previewCoupon","announce","_announce$coupons","removeCoupon","_this2","this","_this3","_this$state3","react_default","a","createElement","react","className","Loader","map","i","key","scope","onClick","Modal_default","show","onHide","Header","closeButton","Title","Body","for","onChange","placeholder","Footer","Button_default","disabled","variant","Component"],"mappings":"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","file":"static/js/36.0083c60a.chunk.js","sourcesContent":["function webpackEmptyContext(req) {\n\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\te.code = 'MODULE_NOT_FOUND';\n\tthrow e;\n}\nwebpackEmptyContext.keys = function() { return []; };\nwebpackEmptyContext.resolve = webpackEmptyContext;\nmodule.exports = webpackEmptyContext;\nwebpackEmptyContext.id = 502;","export let counponToPrint = (logoBase64, infos, montant, datelimite, title, qr, filename) => ({\r\n    defaultFileName: filename,\r\n        pageSize: {\r\n        width: 450,\r\n            height: 'auto'\r\n    },\r\n    fillColor: 'red',\r\n        pageMargins: [35, 40, 35, 40],\r\n            content: [\r\n                {\r\n                    image: \"data:image/png;base64,\" + logoBase64,\r\n                    width: 100,\r\n                    style: { alignment: 'center' }\r\n                },\r\n                { lineHeight: 2, text: 'COUPON DE REDUCTION', fontSize: 15, style: { alignment: 'center', bold: true } },\r\n                {\r\n                    text: [\r\n                        { text: infos+' \\n', fontSize: 14, style: { alignment: 'center', bold: true } },\r\n                        { text: 'Vous béneficiez d\\'une reduction de ' + montant +' \\n', fontSize: 14, color: '#de0027', style: { alignment: 'center' } },\r\n                        { text: 'Pour l\\'annonce: ' + title +' \\n', fontSize: 14, style: { alignment: 'center' } },\r\n                        { text: '\\nOffre valable jusqu\\'au ' + datelimite +' sous présentation au guichet. \\n\\n', fontSize: 10, style: { italics: true, alignment: 'center' } }\r\n                    ]\r\n                },\r\n                // { qr: qr, fit: '80', style: { alignment: 'center' } },\r\n                { text: '\\n www.entrecops.co', fontSize: 10, style: { italics: true, alignment: 'center' } }\r\n            ]\r\n})","import React, { Component, Fragment } from 'react';\r\nimport axios from 'axios';\r\nimport { rootUrl } from '../../../configs/config';\r\n\r\nimport Modal from 'react-bootstrap/Modal';\r\nimport Button from 'react-bootstrap/Button';\r\nimport Loader from '../../globalComponent/Loader';\r\nimport pdfMake from \"pdfmake/build/pdfmake\";\r\nimport pdfFonts from \"pdfmake/build/vfs_fonts\";\r\n\r\nimport logo from '../../../assets/images/logo.png';\r\nimport {counponToPrint} from '../../components/CouponSchema/Coupon'\r\npdfMake.vfs = pdfFonts.pdfMake.vfs;\r\nconst image2base64 = require('image-to-base64');\r\n\r\nclass AdminCoupons extends Component {\r\n\r\n    state = {\r\n        showModal: false,\r\n        error: '',\r\n        loading: false,\r\n        selectedAnnonce: null,\r\n        eventType: '',\r\n        \r\n        event: null,\r\n        events: [],\r\n        eventsLoading: true,\r\n\r\n        services: [],\r\n        service: null,\r\n        servicesLoading: true,\r\n\r\n        nCoupons: '',\r\n        infos: '',\r\n        datelimite: '',\r\n        montant: '',\r\n        couponValid: false,\r\n        couponError: '',\r\n        removing: false\r\n    }\r\n\r\n    handleInputChange = (e) => {\r\n        e.preventDefault();\r\n        const name = e.target.name;\r\n        const value = e.target.value;\r\n        this.setState({\r\n            [name]: value\r\n        }, this.validate);\r\n    }\r\n\r\n    validate = () => {\r\n        const { nCoupons, infos, datelimite, montant} = this.state;\r\n        this.setState({\r\n            couponValid: nCoupons.trim().length > 0\r\n                        && infos.trim().length > 0\r\n                        && datelimite.trim().length > 0\r\n                        && montant.trim().length > 0\r\n        })\r\n    }\r\n\r\n    componentDidMount() {\r\n        //Get all validated events\r\n        axios.get('/api/event/validated/all')\r\n        .then(res => {\r\n            this.setState({ events: res.data.events, eventsLoading: false, error: '' })\r\n        })\r\n        .catch(err => {\r\n            this.setState({ error: \"Une érreur s'est produite. Veuillez reéssayer.\", eventsLoading: false })\r\n        })\r\n\r\n        //Get all validated services\r\n        axios.get('/api/service/validated/all')\r\n        .then(res => {\r\n            this.setState({ services: res.data.services, servicesLoading: false, error: '' })\r\n        })\r\n        .catch(err => {\r\n            this.setState({ error: \"Une érreur s'est produite. Veuillez reéssayer.\", servicesLoading: false })\r\n        })\r\n    }\r\n\r\n    openModal = (id, type) => {\r\n        this.setState({showModal: true, loading: true, eventType: type});\r\n        let url = \"/api/\" + type + \"/\" + id;\r\n        axios.get(url)\r\n        .then(res => {\r\n            const data = type === \"event\" ? res.data.event : res.data.service;\r\n            this.setState({ selectedAnnonce: data, loading: false })\r\n        })\r\n        .catch(err => {\r\n            this.setState({error: 'Une erreur s\\'est produite. Veuillez reéssayer.', loading: false})\r\n        })\r\n    }\r\n\r\n    generateCoupon = () => {\r\n        const {nCoupons, montant, datelimite, infos, eventType, selectedAnnonce} = this.state;\r\n        let clients = [];\r\n        if (selectedAnnonce.coupons) {\r\n            if (selectedAnnonce.coupons.clients) {\r\n                clients = [...selectedAnnonce.coupons.clients];\r\n            }\r\n        }\r\n        this.setState({loading: true});\r\n        const coupon = {\r\n            nCoupons: nCoupons,\r\n            montant: montant,\r\n            datelimite: datelimite,\r\n            title: selectedAnnonce.title,\r\n            infos: infos,\r\n            clients: clients,\r\n            image: rootUrl + '/' + selectedAnnonce.image,\r\n        };\r\n        axios.patch(rootUrl + '/api/' + eventType + '/' + selectedAnnonce._id + '/add/coupon', { coupon: coupon })\r\n        .then(res => {\r\n            const data = eventType === \"event\" ? this.state.events : this.state.services;\r\n            let newEvents = data.filter(event => {\r\n                if (event._id === selectedAnnonce._id) {\r\n                    event.coupons = coupon;\r\n                }\r\n                return event;\r\n            })\r\n            // generate the coupon\r\n            image2base64(logo) // you can also to use url\r\n            .then(response => {\r\n                let docDefinition = counponToPrint(response, infos, montant, datelimite,\r\n                    selectedAnnonce.title, \"Entrecops\", selectedAnnonce.title.split(' ').join('-'))\r\n                pdfMake.createPdf(docDefinition).open();\r\n                this.setState({ loading: false, showModal: false, [eventType+\"s\"]: newEvents })\r\n            })\r\n            .catch((error) => console.log(error))\r\n        })\r\n        .catch(err => {\r\n            this.setState({ loading: false, couponError: 'Une erreur s\\'est produite. Veuillez reéssayer.' });\r\n        })\r\n    }\r\n\r\n    previewCoupon = (announce) => {\r\n        const {infos, datelimite, montant} = announce.coupons;\r\n        image2base64(logo) // you can also to use url\r\n            .then(response => {\r\n                let docDefinition = counponToPrint(response, infos, montant, datelimite,\r\n                    announce.title, \"Entrecops\", announce.title.split(' ').join('-'))\r\n                pdfMake.createPdf(docDefinition).open();\r\n            })\r\n            .catch((error) => console.log(error))\r\n    }\r\n\r\n    removeCoupon = (id, type) => {\r\n        this.setState({ removing: true });\r\n        let url = rootUrl + '/api/' + type + '/' + id + '/remove/coupon';\r\n        axios.patch(url)\r\n        .then(res => {\r\n            const data = type === \"event\" ? this.state.events : this.state.services;\r\n            let newEvents = data.filter(event => {\r\n                if (event._id === id) {\r\n                    event.coupons = null;\r\n                }\r\n                return event;\r\n            })\r\n            this.setState({ removing: false, [type + \"s\"]: newEvents })\r\n        })\r\n        .catch(err => {\r\n            this.setState({ error: 'Une erreur s\\'est produite. Veuillez reéssayer.', loading: false })\r\n        })\r\n    }\r\n\r\n\r\n    render() {\r\n        const { error, events, eventsLoading, services, servicesLoading, selectedAnnonce, loading } = this.state;\r\n        return (\r\n            <Fragment>\r\n                <div className=\"container admin-coupons mt-4\">\r\n                    <div className=\"row pt-5 pb-3\">\r\n                        <div className=\"col\">\r\n                            <h1>Genérer des coupons de réduction</h1>\r\n                        </div>\r\n                    </div>\r\n                    {/* <div className=\"row\">\r\n                        <div className=\"col-sm-12 col-md-8 col-lg-8\">\r\n                            <input type=\"text\" placeholder=\"Rechercher un service / Evènement\" id=\"searchbar\" />\r\n                        </div>\r\n                    </div> */}\r\n                    {/* Evenement */}\r\n                    <div className=\"row\">\r\n                        <div className=\"col-sm-12 py-3\">\r\n                            <h4 className=\"mt-3\">Liste des Evènements</h4>\r\n                        </div>\r\n                        <div className=\"col-sm-12\">\r\n                            {error.length ? <div className=\"alert alert-danger\" style={{ fontSize: \"1.3rem\" }}>{error}</div> : null}\r\n                            {\r\n                                eventsLoading ? <div className=\"d-block mr-auto ml-auto text-center\"><Loader /></div> :\r\n                                    events && events.length ?\r\n                                    <table className=\"table table-bordered\" id=\"thetable\">\r\n                                        <thead className=\"thead-inverse thead-dark\">\r\n                                            <tr>\r\n                                            <th>#</th>\r\n                                            <th>Nom de l'évenement</th>\r\n                                            <th>Coupons Restants</th>\r\n                                            <th>Actions</th>\r\n                                            </tr>\r\n                                        </thead>\r\n                                        <tbody>\r\n                                            {\r\n                                                events.map((event, i) => (\r\n                                                    <tr key={event._id}>\r\n                                                        <th scope=\"row\">{i + 1}</th>\r\n                                                        <td>{event.title}</td>\r\n                                                        <td>{event.coupons ? event.coupons.nCoupons : 0}</td>\r\n                                                        <td className=\"actions text-right\">\r\n                                                            {event.coupons ?\r\n                                                            <Fragment>\r\n                                                                <button className=\"btn btn-dark btn-lg mr-3\" onClick={() => this.previewCoupon(event)}>Afficher le coupon</button>\r\n                                                                <button className=\"btn btn-outline-danger btn-lg\" onClick={() => this.removeCoupon(event._id, \"event\")}>Annuler coupons</button>\r\n                                                            </Fragment>:\r\n                                                            <button className=\"btn btn-danger btn-lg mr-3\" onClick={() => this.openModal(event._id, \"event\")}>Générer des coupons</button>\r\n                                                             }\r\n                                                        </td>\r\n                                                    </tr>\r\n                                                ))\r\n                                            }\r\n                                        </tbody>\r\n                                    </table>:null\r\n                            }\r\n                        </div>\r\n                    </div>\r\n\r\n                    {/* Services */}\r\n                    <div className=\"row mt-4\">\r\n                        <div className=\"col-sm-12 py-3\">\r\n                            <h4 className=\"mt-3\">Liste des Services</h4>\r\n                        </div>\r\n                        <div className=\"col-sm-12\">\r\n                            {error.length ? <div className=\"alert alert-danger\" style={{ fontSize: \"1.3rem\" }}>{error}</div> : null}\r\n                            {\r\n                                servicesLoading ? <div className=\"d-block mr-auto ml-auto text-center\"><Loader /></div> :\r\n                                    services && services.length ?\r\n                                        <table className=\"table table-bordered\">\r\n                                            <thead className=\"thead-inverse thead-dark\">\r\n                                                <tr>\r\n                                                    <th>#</th>\r\n                                                    <th>Nom du service</th>\r\n                                                    <th>Coupons Restants</th>\r\n                                                    <th>Actions</th>\r\n                                                </tr>\r\n                                            </thead>\r\n                                            <tbody>\r\n                                                {\r\n                                                    services.map((service, i) => (\r\n                                                        <tr key={service._id}>\r\n                                                            <th scope=\"row\">{i + 1}</th>\r\n                                                            <td>{service.title}</td>\r\n                                                            <td>{service.coupons ? service.coupons.nCoupons : 0}</td>\r\n                                                            <td className=\"actions\">\r\n                                                                {\r\n                                                                    service.coupons ?\r\n                                                                    <Fragment>\r\n                                                                        <button className=\"btn btn-dark btn-lg mr-3\" onClick={() => this.previewCoupon(service)}>Afficher le coupon</button>\r\n                                                                        <button className=\"btn btn-outline-danger btn-lg\" onClick={() => this.removeCoupon(service._id, \"service\")}>Annuler coupons</button>\r\n                                                                    </Fragment>:\r\n                                                                    <button className=\"btn btn-danger btn-lg mr-3\" onClick={() => this.openModal(service._id, \"service\")}>Générer des coupons</button>\r\n                                                                }\r\n                                                            </td>\r\n                                                        </tr>\r\n                                                    ))\r\n                                                }\r\n                                            </tbody>\r\n                                        </table> : null\r\n                            }\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n\r\n                {/* Générer des coupons */}\r\n                <Modal show={this.state.showModal} onHide={() => this.setState({showModal: !this.state.showModal})} >\r\n                    <Modal.Header closeButton>\r\n                    <Modal.Title>Générer des coupons</Modal.Title>\r\n                    </Modal.Header>\r\n                    <Modal.Body>\r\n                        <div className=\"container\">\r\n                            <div className=\"row\">\r\n                                {\r\n                                    loading ? <div className=\"d-block mr-auto ml-auto text-center\"><Loader /></div>:\r\n                                    selectedAnnonce ?\r\n                                    <div className=\"col-sm-12 pl-4 pr-4 mt-4 mb-3\">\r\n                                        {!this.state.couponValid ? <div className=\"alert alert-danger mb-4\">Veuillez remplis tous les champs</div>:null}\r\n                                        <div className=\"pb-3\">\r\n                                            <h4>Coupons pour: &nbsp;<b>{selectedAnnonce.title}</b></h4>\r\n                                        </div>\r\n                                        <div className=\"form-group\">\r\n                                            <label for=\"name\">Infos sur la réduction</label>\r\n                                            <input type=\"text\" onChange={(e) => this.handleInputChange(e)} value={this.state.infos} name=\"infos\" className=\"form-control\" placeholder=\"Informations\"/>\r\n                                        </div>\r\n                                        <div className=\"form-group\">\r\n                                            <label for=\"name\">Montant / Poucentage de reduction</label>\r\n                                            <input type=\"text\" onChange={(e) => this.handleInputChange(e)} value={this.state.montant} name=\"montant\" className=\"form-control\" placeholder=\"Montant / Pourcentage\"/>\r\n                                        </div>\r\n                                        <div className=\"form-group\">\r\n                                            <label for=\"name\">Date limite de validité</label>\r\n                                            <input type=\"text\" onChange={(e) => this.handleInputChange(e)} value={this.state.datelimite} name=\"datelimite\" className=\"form-control\" placeholder=\"Date limite de validité\"/>\r\n                                        </div>\r\n                                        <div className=\"form-group\">\r\n                                            <label for=\"ncoupons\">Nombre de coupons</label>\r\n                                            <input type=\"number\" onChange={(e) => this.handleInputChange(e)} value={this.state.nCoupons} name=\"nCoupons\" className=\"form-control\" placeholder=\"Nombre de coupons\"/>\r\n                                        </div>\r\n                                        <div className=\"couponwrap\" id=\"couponwrap\">\r\n\r\n                                        </div>\r\n                                    </div>:null\r\n                                }\r\n                            </div>\r\n                        </div>\r\n                    </Modal.Body>\r\n                    <Modal.Footer>\r\n                        <div className=\"py-3\">\r\n                            <Button disabled={!this.state.couponValid} variant=\"danger\" onClick={this.generateCoupon}>\r\n                                Générer\r\n                            </Button>\r\n                            <Button variant=\"default\" className=\"ml-4\" onClick={() => this.setState({showModal: false})}>\r\n                                Fermer\r\n                            </Button>\r\n                        </div>\r\n                    </Modal.Footer>\r\n                </Modal>\r\n            </Fragment>\r\n        );\r\n    }\r\n}\r\n\r\nexport default AdminCoupons;"],"sourceRoot":""}