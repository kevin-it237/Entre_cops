(window.webpackJsonp=window.webpackJsonp||[]).push([[40],{100:function(e,t,a){"use strict";a.d(t,"a",function(){return c}),a.d(t,"b",function(){return o});var n=a(0),l=a.n(n),r=a(101),s=a.n(r),c=(a(127),a(128),function(e){return l.a.createElement(s.a,null)}),o=function(e,t,a){r.store.addNotification({title:t,message:a,type:e,insert:"top",container:"top-center",animationIn:["animated","bounceIn"],animationOut:["animated","fadeOut"],dismiss:{duration:4e3,onScreen:!1}})}},512:function(e,t,a){"use strict";a.r(t);var n=a(13),l=a(89),r=a(15),s=a(16),c=a(19),o=a(17),i=a(18),u=a(0),m=a.n(u),d=a(9),h=a.n(d),E=a(513),f=a.n(E),p=a(514),v=a.n(p),b=a(100),g=a(98),y=a.n(g),N=a(29),k=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(c.a)(this,Object(o.a)(t).call(this,e))).handleInputChange=function(e){var t=e.target.value,r=e.target.name;if("checkbox"===e.target.type){var s=a.state.selectedUsers;if(s.includes(t)){var c=s.filter(function(e){return e!==t});a.setState({selectedUsers:c})}else a.setState(function(e){return{selectedUsers:[].concat(Object(l.a)(e.selectedUsers),[t])}})}else a.setState(Object(n.a)({},r,t))},a.sendEmails=function(){var e=a.state,t=e.object,n=e.content,l=e.selectedUsers;if(t.length<=0||n.length<=0||0===l.length)Object(b.b)("warning","Envoi des Emails!","Selectionez des utilisateurs et remplissez tous les champs");else{a.setState({sending:!0});var r=l.filter(function(e){return e.trim().length>0});h.a.post("/api/email/sendemail/gmail",{object:t,emails:r,html:JSON.stringify(n)}).then(function(e){a.setState({sending:!1,showModal:!1,emailError:"",content:"",object:"",selectedUsers:[]}),Object(b.b)("success","Envoi des Emails!","Emails envoy\xe9s avec succ\xe8s")}).catch(function(e){a.setState({sending:!1,emailError:"Une \xe9rreur ss'est produite"}),console.log(e)})}},a.selectAllUsers=function(e,t,n){var r=document.getElementsByClassName(n),s=document.getElementsByClassName(t);if(r[0].checked){var c=[],o=!0,i=!1,u=void 0;try{for(var m,d=s[Symbol.iterator]();!(o=(m=d.next()).done);o=!0){var h=m.value;h.checked=!0,c.push(h.value)}}catch(N){i=!0,u=N}finally{try{o||null==d.return||d.return()}finally{if(i)throw u}}a.setState({selectedUsers:[].concat(Object(l.a)(a.state.selectedUsers),c)})}else{var E=Object(l.a)(a.state.selectedUsers),f=!0,p=!1,v=void 0;try{for(var b,g=function(){var e=b.value;e.checked=!1,E=E.filter(function(t){return t!==e.value})},y=s[Symbol.iterator]();!(f=(b=y.next()).done);f=!0)g()}catch(N){p=!0,v=N}finally{try{f||null==y.return||y.return()}finally{if(p)throw v}}a.setState({selectedUsers:E})}},a.state={users:[],suppliers:[],loading:!0,sending:!1,selectedUsers:[],content:"",object:"",error:"",emailError:""},a.onChange=function(e){return a.setState({editorState:e})},a}return Object(i.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){var e=this;h.a.get("/api/user").then(function(t){e.setState({loading:!1,users:t.data.users,error:""})}).catch(function(t){e.setState({loading:!1,error:"Erreur, Veuillez re\xe9ssayer"})}),h.a.get("/api/supplier/all").then(function(t){e.setState({loading:!1,suppliers:t.data.suppliers,error:""})}).catch(function(t){e.setState({loading:!1,error:"Erreur, Veuillez re\xe9ssayer"})})}},{key:"render",value:function(){var e=this,t=this.state,a=t.loading,n=t.users,l=t.suppliers,r=t.error,s=t.selectedUsers,c=t.content,o=t.object,i=t.sending,d=t.emailError;return console.log(c),m.a.createElement(u.Fragment,null,m.a.createElement(b.a,null),m.a.createElement("div",{className:"container mt-4"},m.a.createElement("div",{className:"row pt-5 pb-3"},m.a.createElement("div",{className:"col-sm-12"},m.a.createElement("h2",null,"Envoi des Emails")),r&&r.length?m.a.createElement("div",{className:"alert alert-danger"},r):null,a?m.a.createElement("div",{className:"col-sm-12"},m.a.createElement("div",{className:"d-flex justify-content-center"},m.a.createElement(N.default,null))):m.a.createElement(u.Fragment,null,m.a.createElement("div",{className:"col-sm-12 user-list"},m.a.createElement("h4",{className:"mb-4 mt-4"},"Liste des utilisateurs"),m.a.createElement("table",{className:"table table-bordered reservations-list"},m.a.createElement("thead",{className:"thead-inverse thead-dark"},m.a.createElement("tr",null,m.a.createElement("th",null,"#"),m.a.createElement("th",null,"Nom"),m.a.createElement("th",null,"Email"),m.a.createElement("th",null,"Actions ",m.a.createElement("input",{onChange:function(t){return e.selectAllUsers(t,"user-check","user-check-verify")},type:"checkbox",className:"form-check-inline user-check-verify"})))),m.a.createElement("tbody",null,n.map(function(t,a){return m.a.createElement("tr",{key:a},m.a.createElement("th",{scope:"row"},a+1),m.a.createElement("td",null,t.name),m.a.createElement("td",null,t.email),m.a.createElement("td",null,m.a.createElement("input",{onChange:function(t){return e.handleInputChange(t)},type:"checkbox",className:"form-check-inline user-check",value:t.email})))})))),m.a.createElement("div",{className:"col-sm-12 supplier-list"},m.a.createElement("h4",{className:"mb-4 mt-4"},"Liste des Fournisseurs"),m.a.createElement("table",{className:"table table-bordered reservations-list"},m.a.createElement("thead",{className:"thead-inverse thead-dark"},m.a.createElement("tr",null,m.a.createElement("th",null,"#"),m.a.createElement("th",null,"Nom"),m.a.createElement("th",null,"Email"),m.a.createElement("th",null,"Actions ",m.a.createElement("input",{onChange:function(t){return e.selectAllUsers(t,"supplier-check","supplier-check-verify")},type:"checkbox",className:"form-check-inline supplier-check-verify"})))),m.a.createElement("tbody",null,l.map(function(t,a){return m.a.createElement("tr",{key:a},m.a.createElement("th",{scope:"row"},a+1),m.a.createElement("td",null,t.name),m.a.createElement("td",null,t.email),m.a.createElement("td",null,m.a.createElement("input",{onChange:function(t){return e.handleInputChange(t)},type:"checkbox",className:"form-check-inline supplier-check",name:t.email,value:t.email})))})))),m.a.createElement("button",{onClick:function(){return e.setState({showModal:!0})},className:"button send-email-btn"},"Envoyer un Email (",this.state.selectedUsers.length,")")))),m.a.createElement(y.a,{show:this.state.showModal,onHide:function(){return e.setState({showModal:!e.state.showModal})},size:"lg"},m.a.createElement(y.a.Header,{closeButton:!0},m.a.createElement(y.a.Title,null,"Envoi du mail")),m.a.createElement(y.a.Body,null,m.a.createElement("div",{className:"container"},m.a.createElement("div",{className:"row"},m.a.createElement("div",{className:"col"},d&&d.length?m.a.createElement("div",{className:"alert alert-danger"},d):null,m.a.createElement("div",{className:"d-flex mb-4 flex-wrap"},s.map(function(e,t){return m.a.createElement("p",{className:"user-email-item",key:t},e)})),m.a.createElement("div",{className:"form-group"},m.a.createElement("label",{for:"name"},"Objet"),m.a.createElement("input",{type:"text",className:"form-control",value:o,onChange:function(t){return e.handleInputChange(t)},name:"object",placeholder:"Objet",required:!0})),m.a.createElement("div",{className:"form-group"},m.a.createElement("label",{for:"name"},"Contenu"),m.a.createElement(f.a,{editor:v.a,data:"",config:{toolbar:["heading","|","bold","italic","insertTable","tableColumn","tableRow","mergeTableCells","|","undo","redo"]},onInit:function(e){console.log("Editor is ready to use!",e)},onChange:function(t,a){var n=a.getData();e.setState({content:n})},onBlur:function(e,t){console.log("Blur.",t)},onFocus:function(e,t){console.log("Focus.",t)}})),m.a.createElement("div",{className:"d-flex justify-content-end"},m.a.createElement("button",{onClick:this.sendEmails,className:"button my-4"},"Envoyer (",s.length,") ",i&&m.a.createElement(N.default,{color:"white"})))))))))}}]),t}(u.Component);t.default=k}}]);
//# sourceMappingURL=40.ac8a6f88.chunk.js.map