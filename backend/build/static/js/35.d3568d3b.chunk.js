(window.webpackJsonp=window.webpackJsonp||[]).push([[35],{120:function(e,t,a){"use strict";a.d(t,"a",function(){return c}),a.d(t,"b",function(){return s});var n=a(0),l=a.n(n),o=a(125),r=a.n(o),c=(a(165),a(166),function(e){return l.a.createElement(r.a,null)}),s=function(e,t,a){o.store.addNotification({title:t,message:a,type:e,insert:"top",container:"top-center",animationIn:["animated","bounceIn"],animationOut:["animated","fadeOut"],dismiss:{duration:4e3,onScreen:!1}})}},219:function(e,t,a){"use strict";a.d(t,"a",function(){return c});var n=a(0),l=a.n(n),o=a(108),r=a.n(o),c=function(e){return l.a.createElement("div",{className:"container-fluid"},l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"col-sm-12 py-5 px-4",style:{border:"solid 1px #eee",backgroundColor:"#fafafa"}},l.a.createElement("img",{src:r.a,alt:"",width:"100"}),l.a.createElement("h3",{className:"mt-2"},l.a.createElement("strong",null,"COUPON DE REDUCTION")),l.a.createElement("h3",{className:"mt-4"},l.a.createElement("strong",null,e.coupon.infos)),l.a.createElement("h3",null,l.a.createElement("strong",{className:"text-danger",style:{color:"#de0027"}},"Vous b\xe9neficiez d'une reduction de ",e.coupon.montant)),l.a.createElement("h3",null,"Pour l'annonce: ",e.coupon.title),l.a.createElement("h5",{className:"mt-4"},l.a.createElement("i",null,"Offre valable jusqu'au ",e.coupon.datelimite," sous pr\xe9sentation au guichet.")))))}},509:function(e,t,a){"use strict";var n=a(2),l=a(4),o=a(102),r=a.n(o),c=a(0),s=a.n(c),i=a(123),u=a(246),m=s.a.forwardRef(function(e,t){var a=e.bsPrefix,o=e.variant,c=e.size,m=e.active,d=e.className,p=e.block,v=e.type,E=e.as,f=Object(l.a)(e,["bsPrefix","variant","size","active","className","block","type","as"]),h=Object(i.b)(a,"btn"),b=r()(d,h,m&&"active",h+"-"+o,p&&h+"-block",c&&h+"-"+c);if(f.href)return s.a.createElement(u.a,Object(n.a)({},f,{as:E,ref:t,className:r()(b,f.disabled&&"disabled")}));t&&(f.ref=t),E||(f.type=v);var g=E||"button";return s.a.createElement(g,Object(n.a)({},f,{className:b}))});m.displayName="Button",m.defaultProps={variant:"primary",active:!1,disabled:!1,type:"button"},t.a=m},512:function(e,t,a){"use strict";a.r(t);var n=a(114),l=a(13),o=a(15),r=a(16),c=a(19),s=a(17),i=a(18),u=a(0),m=a.n(u),d=a(9),p=a.n(d),v=a(29),E=a(612),f=a(508),h=a(613),b=a(509),g=a(105),N=a(103),C=a(219),w=a(120),y=function(e){function t(){var e,a;Object(o.a)(this,t);for(var r=arguments.length,i=new Array(r),u=0;u<r;u++)i[u]=arguments[u];return(a=Object(c.a)(this,(e=Object(s.a)(t)).call.apply(e,[this].concat(i)))).state={showModal:!1,error:"",loading:!1,selectedAnnonce:null,eventType:"",event:null,events:[],eventsLoading:!0,services:[],service:null,servicesLoading:!0,nCoupons:"",infos:"",datelimite:"",montant:"",couponValid:!1,couponError:"",removing:!1,showCouponPreviewModal:!1,coupon:null},a.handleInputChange=function(e){e.preventDefault();var t=e.target.name,n=e.target.value;a.setState(Object(l.a)({},t,n),a.validate)},a.validate=function(){var e=a.state,t=e.nCoupons,n=e.infos,l=e.datelimite,o=e.montant;a.setState({couponValid:t.trim().length>0&&n.trim().length>0&&l.trim().length>0&&o.trim().length>0})},a.openModal=function(e,t){a.setState({showModal:!0,loading:!0,eventType:t});var n="/api/"+t+"/"+e;p.a.get(n).then(function(e){var n="event"===t?e.data.event:e.data.service;a.setState({selectedAnnonce:n,loading:!1})}).catch(function(e){a.setState({error:"Une erreur s'est produite. Veuillez re\xe9ssayer.",loading:!1})})},a.generateCoupon=function(){var e=a.state,t=e.nCoupons,o=e.montant,r=e.datelimite,c=e.infos,s=e.eventType,i=e.selectedAnnonce,u=[];i.coupons&&i.coupons.clients&&(u=Object(n.a)(i.coupons.clients)),a.setState({loading:!0});var m={nCoupons:t,montant:o,datelimite:r,title:i.title,infos:c,clients:u,image:v.a+"/"+i.image};p.a.patch(v.a+"/api/"+s+"/"+i._id+"/add/coupon",{coupon:m}).then(function(e){var t=("event"===s?a.state.events:a.state.services).filter(function(e){return e._id===i._id&&(e.coupons=m),e});a.setState(Object(l.a)({loading:!1,showModal:!1},s+"s",t)),Object(w.b)("success","Coupon!","Coupon g\xe9n\xe9r\xe9 avec succ\xe8s")}).catch(function(e){a.setState({loading:!1,couponError:"Une erreur s'est produite. Veuillez re\xe9ssayer."})})},a.previewCoupon=function(e){a.setState({showCouponPreviewModal:!0,coupon:e.coupons})},a.removeCoupon=function(e,t){a.setState({removing:!0});var n=v.a+"/api/"+t+"/"+e+"/remove/coupon";p.a.patch(n).then(function(n){var o=("event"===t?a.state.events:a.state.services).filter(function(t){return t._id===e&&(t.coupons=null),t});a.setState(Object(l.a)({removing:!1},t+"s",o)),Object(w.b)("success","Coupon!","Coupon annul\xe9 avec succ\xe8s")}).catch(function(e){a.setState({error:"Une erreur s'est produite. Veuillez re\xe9ssayer.",loading:!1})})},a}return Object(i.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){var e=this;p.a.get("/api/event/validated/all").then(function(t){e.setState({events:t.data.events,eventsLoading:!1,error:""})}).catch(function(t){e.setState({error:"Une \xe9rreur s'est produite. Veuillez re\xe9ssayer.",eventsLoading:!1})}),p.a.get("/api/service/validated/all").then(function(t){e.setState({services:t.data.services,servicesLoading:!1,error:""})}).catch(function(t){e.setState({error:"Une \xe9rreur s'est produite. Veuillez re\xe9ssayer.",servicesLoading:!1})})}},{key:"render",value:function(){var e=this,t=this.state,a=t.error,n=t.events,l=t.eventsLoading,o=t.services,r=t.servicesLoading,c=t.selectedAnnonce,s=t.loading;return m.a.createElement(N.a,null,m.a.createElement(w.a,null),m.a.createElement("div",{className:"container admin-coupons mt-4"},m.a.createElement("div",{className:"row pt-5 pb-3"},m.a.createElement("div",{className:"col"},m.a.createElement("h1",null,"Gen\xe9rer des coupons de r\xe9duction"))),m.a.createElement("div",{className:"row mt-3"},m.a.createElement("div",{className:"col-sm-12"},a.length?m.a.createElement("div",{className:"alert alert-danger",style:{fontSize:"1.3rem"}},a):null),m.a.createElement("div",{className:"col-sm-12"},m.a.createElement(E.a,{defaultActiveKey:"events",id:"uncontrolled-tab-example"},m.a.createElement(f.a,{eventKey:"events",title:"Actualit\xe9s"},l?m.a.createElement("div",{className:"d-block mr-auto ml-auto text-center mt-5"},m.a.createElement(g.a,null)):n&&n.length?m.a.createElement("table",{className:"table table-bordered tabs",id:"thetable"},m.a.createElement("thead",{className:"thead-inverse thead-dark"},m.a.createElement("tr",null,m.a.createElement("th",null,"#"),m.a.createElement("th",null,"Nom de l'\xe9venement"),m.a.createElement("th",null,"Coupons Restants"),m.a.createElement("th",null,"Actions"))),m.a.createElement("tbody",null,n.map(function(t,a){return m.a.createElement("tr",{key:t._id},m.a.createElement("th",{scope:"row"},a+1),m.a.createElement("td",null,t.title),m.a.createElement("td",null,t.coupons?t.coupons.nCoupons:0),m.a.createElement("td",{className:"actions text-right"},t.coupons?m.a.createElement(N.a,null,m.a.createElement("button",{className:"btn btn-dark btn-lg mr-3",onClick:function(){return e.previewCoupon(t)}},"Afficher le coupon"),m.a.createElement("button",{className:"btn btn-outline-danger btn-lg",onClick:function(){return e.removeCoupon(t._id,"event")}},"Annuler coupons")):m.a.createElement("button",{className:"btn btn-danger btn-lg mr-3",onClick:function(){return e.openModal(t._id,"event")}},"G\xe9n\xe9rer des coupons")))}))):null),m.a.createElement(f.a,{eventKey:"services",title:"Services"},r?m.a.createElement("div",{className:"d-block mr-auto ml-auto text-center mt-5"},m.a.createElement(g.a,null)):o&&o.length?m.a.createElement("table",{className:"table table-bordered"},m.a.createElement("thead",{className:"thead-inverse thead-dark"},m.a.createElement("tr",null,m.a.createElement("th",null,"#"),m.a.createElement("th",null,"Nom du service"),m.a.createElement("th",null,"Coupons Restants"),m.a.createElement("th",null,"Actions"))),m.a.createElement("tbody",null,o.map(function(t,a){return m.a.createElement("tr",{key:t._id},m.a.createElement("th",{scope:"row"},a+1),m.a.createElement("td",null,t.title),m.a.createElement("td",null,t.coupons?t.coupons.nCoupons:0),m.a.createElement("td",{className:"actions"},t.coupons?m.a.createElement(N.a,null,m.a.createElement("button",{className:"btn btn-dark btn-lg mr-3",onClick:function(){return e.previewCoupon(t)}},"Afficher le coupon"),m.a.createElement("button",{className:"btn btn-outline-danger btn-lg",onClick:function(){return e.removeCoupon(t._id,"service")}},"Annuler coupons")):m.a.createElement("button",{className:"btn btn-danger btn-lg mr-3",onClick:function(){return e.openModal(t._id,"service")}},"G\xe9n\xe9rer des coupons")))}))):null))))),m.a.createElement(h.a,{show:this.state.showModal,onHide:function(){return e.setState({showModal:!e.state.showModal})}},m.a.createElement(h.a.Header,{closeButton:!0},m.a.createElement(h.a.Title,null,"G\xe9n\xe9rer des coupons")),m.a.createElement(h.a.Body,null,m.a.createElement("div",{className:"container"},m.a.createElement("div",{className:"row"},s?m.a.createElement("div",{className:"d-block mr-auto ml-auto text-center"},m.a.createElement(g.a,null)):c?m.a.createElement("div",{className:"col-sm-12 pl-4 pr-4 mt-4 mb-3"},this.state.couponValid?null:m.a.createElement("div",{className:"alert alert-danger mb-4"},"Veuillez remplis tous les champs"),m.a.createElement("div",{className:"pb-3"},m.a.createElement("h4",null,"Coupons pour: \xa0",m.a.createElement("b",null,c.title))),m.a.createElement("div",{className:"form-group"},m.a.createElement("label",{for:"name"},"Infos sur la r\xe9duction"),m.a.createElement("input",{type:"text",onChange:function(t){return e.handleInputChange(t)},value:this.state.infos,name:"infos",className:"form-control",placeholder:"Informations"})),m.a.createElement("div",{className:"form-group"},m.a.createElement("label",{for:"name"},"Montant / Poucentage de reduction"),m.a.createElement("input",{type:"text",onChange:function(t){return e.handleInputChange(t)},value:this.state.montant,name:"montant",className:"form-control",placeholder:"Montant / Pourcentage"})),m.a.createElement("div",{className:"form-group"},m.a.createElement("label",{for:"name"},"Date limite de validit\xe9"),m.a.createElement("input",{type:"text",onChange:function(t){return e.handleInputChange(t)},value:this.state.datelimite,name:"datelimite",className:"form-control",placeholder:"Date limite de validit\xe9"})),m.a.createElement("div",{className:"form-group"},m.a.createElement("label",{for:"ncoupons"},"Nombre de coupons"),m.a.createElement("input",{type:"number",onChange:function(t){return e.handleInputChange(t)},value:this.state.nCoupons,name:"nCoupons",className:"form-control",placeholder:"Nombre de coupons"})),m.a.createElement("div",{className:"couponwrap",id:"couponwrap"})):null))),m.a.createElement(h.a.Footer,null,m.a.createElement("div",{className:"py-3"},m.a.createElement(b.a,{disabled:!this.state.couponValid,variant:"danger",onClick:this.generateCoupon},"G\xe9n\xe9rer"),m.a.createElement(b.a,{variant:"default",className:"ml-4",onClick:function(){return e.setState({showModal:!1})}},"Fermer")))),m.a.createElement(h.a,{show:this.state.showCouponPreviewModal,onHide:function(){return e.setState({showCouponPreviewModal:!1})},size:"md"},m.a.createElement(h.a.Header,{closeButton:!0},m.a.createElement(h.a.Title,null,"Coupon de r\xe9duction")),m.a.createElement(h.a.Body,null,m.a.createElement("div",{className:"container"},m.a.createElement("div",{className:"row justify-content-between"},m.a.createElement("div",{className:"col-sm-12 pl-4 pr-4 mt-4 mb-3 text-center"},m.a.createElement(C.a,{coupon:this.state.coupon}))))),m.a.createElement(h.a.Footer,null,m.a.createElement("div",{className:"py-3"},m.a.createElement(b.a,{variant:"default",onClick:function(){return e.setState({showCouponPreviewModal:!1})}},"Fermer")))))}}]),t}(u.Component);t.default=y}}]);
//# sourceMappingURL=35.d3568d3b.chunk.js.map