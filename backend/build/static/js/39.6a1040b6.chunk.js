(window.webpackJsonp=window.webpackJsonp||[]).push([[39],{120:function(e,t,a){"use strict";a.d(t,"a",function(){return c}),a.d(t,"b",function(){return i});var n=a(0),l=a.n(n),r=a(125),s=a.n(r),c=(a(165),a(166),function(e){return l.a.createElement(s.a,null)}),i=function(e,t,a){r.store.addNotification({title:t,message:a,type:e,insert:"top",container:"top-center",animationIn:["animated","bounceIn"],animationOut:["animated","fadeOut"],dismiss:{duration:4e3,onScreen:!1}})}},519:function(e,t,a){"use strict";a.r(t);var n=a(13),l=a(114),r=a(15),s=a(16),c=a(19),i=a(17),o=a(18),m=a(0),u=a.n(m),d=a(9),E=a.n(d),h=a(120),f=a(520),p=(a(610),a(403)),v=a(611),b=a.n(v),g=a(612),y=a(508),N=a(613),k=a(105),S=a(103),w=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(c.a)(this,Object(i.a)(t).call(this,e))).handleInputChange=function(e){var t=e.target.value,r=e.target.name;if("checkbox"===e.target.type){var s=a.state.selectedUsers;if(s.includes(t)){var c=s.filter(function(e){return e!==t});a.setState({selectedUsers:c})}else a.setState(function(e){return{selectedUsers:[].concat(Object(l.a)(e.selectedUsers),[t])}})}else a.setState(Object(n.a)({},r,t))},a.onEditorStateChange=function(e){a.setState({editorState:e,content:b()(Object(p.convertToRaw)(e.getCurrentContent()))})},a.sendEmails=function(){var e=a.state,t=e.object,n=e.content,l=e.selectedUsers;if(t.length<=0||n.length<=0||0===l.length)Object(h.b)("warning","Envoi des Emails!","Selectionez des utilisateurs et remplissez tous les champs");else{a.setState({sending:!0});var r=l.filter(function(e){return e.trim().length>0});E.a.post("/api/email/sendemail/gmail",{object:t,emails:r,html:JSON.stringify(n)}).then(function(e){a.setState({sending:!1,showModal:!1,emailError:"",content:"",object:"",selectedUsers:[]}),Object(h.b)("success","Envoi des Emails!","Emails envoy\xe9s avec succ\xe8s")}).catch(function(e){a.setState({sending:!1,emailError:"Une \xe9rreur ss'est produite"}),console.log(e)})}},a.selectAllUsers=function(e,t,n){var r=document.getElementsByClassName(n),s=document.getElementsByClassName(t);if(r[0].checked){var c=[],i=!0,o=!1,m=void 0;try{for(var u,d=s[Symbol.iterator]();!(i=(u=d.next()).done);i=!0){var E=u.value;E.checked=!0,c.push(E.value)}}catch(N){o=!0,m=N}finally{try{i||null==d.return||d.return()}finally{if(o)throw m}}a.setState({selectedUsers:[].concat(Object(l.a)(a.state.selectedUsers),c)})}else{var h=Object(l.a)(a.state.selectedUsers),f=!0,p=!1,v=void 0;try{for(var b,g=function(){var e=b.value;e.checked=!1,h=h.filter(function(t){return t!==e.value})},y=s[Symbol.iterator]();!(f=(b=y.next()).done);f=!0)g()}catch(N){p=!0,v=N}finally{try{f||null==y.return||y.return()}finally{if(p)throw v}}a.setState({selectedUsers:h})}},a.state={users:[],suppliers:[],loading:!0,sending:!1,selectedUsers:[],content:"",object:"",error:"",emailError:"",editorState:p.EditorState.createEmpty()},a.onChange=function(e){return a.setState({editorState:e})},a}return Object(o.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){var e=this;E.a.get("/api/user").then(function(t){e.setState({loading:!1,users:t.data.users,error:""})}).catch(function(t){e.setState({loading:!1,error:"Erreur, Veuillez re\xe9ssayer"})}),E.a.get("/api/supplier/all").then(function(t){e.setState({loading:!1,suppliers:t.data.suppliers,error:""})}).catch(function(t){e.setState({loading:!1,error:"Erreur, Veuillez re\xe9ssayer"})})}},{key:"render",value:function(){var e=this,t=this.state,a=t.loading,n=t.users,l=t.suppliers,r=t.error,s=t.selectedUsers,c=t.object,i=t.sending,o=t.emailError,m=t.editorState;return u.a.createElement(S.a,null,u.a.createElement(h.a,null),u.a.createElement("div",{className:"container mt-4"},u.a.createElement("div",{className:"row pt-5 pb-3"},u.a.createElement("div",{className:"col-sm-12"},r&&r.length?u.a.createElement("div",{className:"alert alert-danger"},r):null),u.a.createElement("div",{className:"col-sm-12"},u.a.createElement(g.a,{defaultActiveKey:"users",id:"uncontrolled-tab-example"},u.a.createElement(y.a,{eventKey:"users",title:"Utilisateurs"},a?u.a.createElement("div",{className:"col-sm-12"},u.a.createElement("div",{className:"d-flex justify-content-center mt-5"},u.a.createElement(k.a,null))):u.a.createElement(S.a,null,u.a.createElement("div",{className:"col-sm-12 user-list"},u.a.createElement("table",{className:"table table-bordered reservations-list"},u.a.createElement("thead",{className:"thead-inverse thead-dark"},u.a.createElement("tr",null,u.a.createElement("th",null,"#"),u.a.createElement("th",null,"Nom"),u.a.createElement("th",null,"Email"),u.a.createElement("th",null,"Actions ",u.a.createElement("input",{onChange:function(t){return e.selectAllUsers(t,"user-check","user-check-verify")},type:"checkbox",className:"form-check-inline user-check-verify"})))),u.a.createElement("tbody",null,n.map(function(t,a){return u.a.createElement("tr",{key:a},u.a.createElement("th",{scope:"row"},a+1),u.a.createElement("td",null,t.name),u.a.createElement("td",null,t.email),u.a.createElement("td",null,u.a.createElement("input",{onChange:function(t){return e.handleInputChange(t)},type:"checkbox",className:"form-check-inline user-check",value:t.email})))})))))),u.a.createElement(y.a,{eventKey:"suppliers",title:"Fournisseurs"},a?u.a.createElement("div",{className:"col-sm-12"},u.a.createElement("div",{className:"d-flex justify-content-center mt-5"},u.a.createElement(k.a,null))):u.a.createElement(S.a,null,u.a.createElement("div",{className:"col-sm-12 supplier-list"},u.a.createElement("table",{className:"table table-bordered reservations-list"},u.a.createElement("thead",{className:"thead-inverse thead-dark"},u.a.createElement("tr",null,u.a.createElement("th",null,"#"),u.a.createElement("th",null,"Nom"),u.a.createElement("th",null,"Email"),u.a.createElement("th",null,"Actions ",u.a.createElement("input",{onChange:function(t){return e.selectAllUsers(t,"supplier-check","supplier-check-verify")},type:"checkbox",className:"form-check-inline supplier-check-verify"})))),u.a.createElement("tbody",null,l.map(function(t,a){return u.a.createElement("tr",{key:a},u.a.createElement("th",{scope:"row"},a+1),u.a.createElement("td",null,t.name),u.a.createElement("td",null,t.email),u.a.createElement("td",null,u.a.createElement("input",{onChange:function(t){return e.handleInputChange(t)},type:"checkbox",className:"form-check-inline supplier-check",name:t.email,value:t.email})))}))))))),u.a.createElement("button",{onClick:function(){return e.setState({showModal:!0})},className:"button send-email-btn"},"Envoyer un Email (",this.state.selectedUsers.length,")")))),u.a.createElement(N.a,{show:this.state.showModal,onHide:function(){return e.setState({showModal:!e.state.showModal})},size:"lg"},u.a.createElement(N.a.Header,{closeButton:!0},u.a.createElement(N.a.Title,null,"Envoi du mail")),u.a.createElement(N.a.Body,null,u.a.createElement("div",{className:"container"},u.a.createElement("div",{className:"row"},u.a.createElement("div",{className:"col-sm-12"},o&&o.length?u.a.createElement("div",{className:"alert alert-danger"},o):null,u.a.createElement("div",{className:"d-flex mb-4 flex-wrap"},s.map(function(e,t){return u.a.createElement("p",{className:"user-email-item",key:t},e)})),u.a.createElement("div",{className:"form-group"},u.a.createElement("label",{for:"name"},"Objet"),u.a.createElement("br",null),u.a.createElement("input",{type:"text",className:"form-control",value:c,onChange:function(t){return e.handleInputChange(t)},name:"object",placeholder:"Objet",required:!0})),u.a.createElement("div",{className:"form-group"},u.a.createElement("label",{for:"name"},"Contenu"),u.a.createElement(f.Editor,{editorState:m,wrapperClassName:"wrapper-class",editorClassName:"editor-class",toolbarClassName:"toolbar-class",onEditorStateChange:this.onEditorStateChange})),u.a.createElement("div",{className:"d-flex justify-content-end"},u.a.createElement("button",{onClick:this.sendEmails,className:"button my-4"},"Envoyer (",s.length,") ",i&&u.a.createElement(k.a,{color:"white"})))))))))}}]),t}(m.Component);t.default=w}}]);
//# sourceMappingURL=39.6a1040b6.chunk.js.map