(window.webpackJsonp=window.webpackJsonp||[]).push([[24],{100:function(e,t){e.exports=function(e){return e&&e.__esModule?e:{default:e}}},103:function(e,t,a){"use strict";t.a=function(e){return e.children}},105:function(e,t,a){"use strict";var n=a(0),r=a.n(n);t.a=function(e){return r.a.createElement("div",{className:"spinner-border",role:"status",style:{color:e.color}},r.a.createElement("span",{className:"sr-only"},"Loading..."))}},108:function(e,t,a){e.exports=a.p+"static/media/logo.919201fe.png"},114:function(e,t,a){"use strict";function n(e){return function(e){if(Array.isArray(e)){for(var t=0,a=new Array(e.length);t<e.length;t++)a[t]=e[t];return a}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}a.d(t,"a",function(){return n})},116:function(e,t,a){"use strict";var n=a(15),r=a(16),s=a(19),l=a(17),c=a(18),i=a(0),o=a.n(i),m=a(24),u=a(109),d=a(20),p=a(30),h=a(110),f=(a(121),a(108)),g=a.n(f),v=a(124),E=a.n(v),N=a(114),b=(a(119),function(e){function t(){return Object(n.a)(this,t),Object(s.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(c.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=Object(N.a)(this.props.recommandations.reverse());return e.reverse(),o.a.createElement("div",{className:"recommandations d-flex flex-column"},e.slice(0,5).map(function(e,t){return o.a.createElement("div",{key:t,className:e.visited?"rec-item":"notvisited rec-item"},o.a.createElement("a",{href:e.link},o.a.createElement("h4",null,e.title),o.a.createElement("div",{className:"d-flex"},o.a.createElement("div",{className:"d-flex flex-row align-items-center"},o.a.createElement(u.a,{icon:h.l,size:"1x"}),o.a.createElement("h6",{className:"ml-2 mb-0"},"Par ",e.name)))))}))}}]),t}(i.Component)),y=a(29),S=(a(122),a(9)),k=a.n(S),x=a(105),j=function(e){function t(){var e,a;Object(n.a)(this,t);for(var r=arguments.length,c=new Array(r),i=0;i<r;i++)c[i]=arguments[i];return(a=Object(s.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(c)))).state={searching:!1,results:[],error:""},a}return Object(c.a)(t,e),Object(r.a)(t,[{key:"componentDidUpdate",value:function(e){var t=this;if(e.query!==this.props.query)if(this.props.query&&this.props.query.trim().length>0){var a=this.props.query;this.setState({searching:!0,results:[]}),k.a.get("/api/event/"+a+"/search").then(function(e){var n=[];e.data.events.forEach(function(e){e.eventType="event",t.state.results.includes(e)||n.push(e)}),k.a.get("/api/service/"+a+"/search").then(function(e){var a=[];e.data.services.forEach(function(e){e.eventType="service",t.state.results.includes(e)||a.push(e)}),t.setState({results:[].concat(n,a),searching:!1})}).catch(function(e){t.setState({error:"Une \xe9rreur s'est produite. Veuillez recharger",searching:!1})})}).catch(function(e){t.setState({error:"Une \xe9rreur s'est produite. Veuillez recharger",searching:!1})})}else this.setState({searching:!1})}},{key:"render",value:function(){return o.a.createElement("div",{className:"searchResult-list ".concat(this.props.className)},this.state.error.length?o.a.createElement("div",{className:"alert alert-danger text-center"},this.state.error):null,this.state.searching?o.a.createElement("div",{className:"d-flex justify-content-center p-3"},o.a.createElement(x.a,null)):this.state.results.length?this.state.results.slice(0,10).map(function(e,t){return o.a.createElement(O,{key:t,result:e})}):o.a.createElement("div",{className:"d-flex justify-content-center p-3"},o.a.createElement("span",null,"Aucun r\xe9sultat")))}}]),t}(i.PureComponent),O=function(e){return o.a.createElement("a",{href:"/annonce/"+e.result.eventType+"/"+e.result._id,className:"d-flex searchResult-item"},o.a.createElement("img",{src:y.a+"/"+e.result.image,alt:"",className:"mr-3"}),o.a.createElement("div",{className:"d-flex flex-column "},o.a.createElement("h3",null,e.result.title),o.a.createElement("span",{className:"text-muted"},e.result.category)))},w=a(103),I=function(e){function t(){var e,a;Object(n.a)(this,t);for(var r=arguments.length,c=new Array(r),i=0;i<r;i++)c[i]=arguments[i];return(a=Object(s.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(c)))).state={user:null,name:"",token:null,role:"",accountValidated:null,redirect:!1,query:""},a.logout=function(){a.props.onLogout()},a.handleInputChange=function(e){var t=e.target.value;a.setState({query:t})},a}return Object(c.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=JSON.parse(localStorage.getItem("authData"));if(t&&t.user){this.setState({user:t.user,name:t.user.name,token:t.token,role:t.user.role,accountValidated:t.user.accountValidated});var a=E()(y.a);a.on("display notification",function(t){var a=JSON.parse(localStorage.getItem("authData"));a&&a.user&&a.user._id===t.to&&e.props.onAutoSign()}),a.on("display anounce notification",function(t){var a=JSON.parse(localStorage.getItem("authData"));a&&a.user&&e.props.onAutoSign()})}}},{key:"componentDidUpdate",value:function(e){e.user!==this.props.user&&this.setState({user:this.props.user,name:this.props.name,token:this.props.token,role:this.props.role,accountValidated:this.props.accountValidated})}},{key:"render",value:function(){var e=this,t=this.state,a=t.name,n=t.token,r=t.role,s=t.accountValidated,l=t.user,c=0;l&&l.recommandations&&l.recommandations.length&&(c=l.recommandations.filter(function(e){return!1===e.visited}).length);return o.a.createElement(w.a,null,o.a.createElement("nav",{className:(this.props.home,"navbar navbar-expand-lg navbar-light bg-light navbar-shadow")},o.a.createElement("div",{className:"container"},o.a.createElement("button",{className:"navbar-toggler",type:"button","data-toggle":"collapse","data-target":"#navbarTogglerDemo03","aria-controls":"navbarTogglerDemo03","aria-expanded":"false","aria-label":"Toggle navigation"},o.a.createElement("span",{className:"navbar-toggler-icon"})),o.a.createElement("div",{className:"search-wrapper"},o.a.createElement("form",{className:"form-inline d-lg-none my-2 my-lg-0 navbar-brand form-mobile"},o.a.createElement("input",{onChange:function(t){return e.handleInputChange(t)},className:"form-control mr-sm-2",type:"text",placeholder:"Rechercher...","aria-label":"Rechercher..."}),o.a.createElement(u.a,{icon:h.j,size:"2x"})),this.state.query.trim().length>0?o.a.createElement(j,{query:this.state.query,className:"d-lg-none"}):null),n?o.a.createElement("div",{className:"dropdown-mobile mt-2"},o.a.createElement("a",{href:"/recommandations",className:"",id:"dropdownMenuButton","data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false"},o.a.createElement(u.a,{icon:h.b,size:"1x"}),o.a.createElement("sup",{className:"ml-1"},l.recommandations&&l.recommandations.length?l.recommandations.length:0)),l.recommandations&&l.recommandations.length?o.a.createElement("div",{className:"dropdown-menu","aria-labelledby":"dropdownMenuButton"},o.a.createElement(b,{recommandations:l.recommandations.reverse()}),o.a.createElement("div",{className:"notifications-link py-2"},o.a.createElement("a",{id:"notifications-link",className:"notifications-link pt-3 text-center",href:"/user/notifications"},"Voir toutes les notifications"))):null):null,o.a.createElement(m.b,{className:"navbar-brand",to:"/"},o.a.createElement("img",{src:g.a,width:"110",height:"100%",alt:"Logo"})),o.a.createElement("div",{className:"collapse navbar-collapse",id:"navbarTogglerDemo03"},o.a.createElement("div",{className:"ml-auto search-wrapper"},o.a.createElement("form",{className:"form-inline d-none d-lg-block my-2 my-lg-0 ml-auto mr-4 form-desktop"},o.a.createElement("input",{onChange:function(t){return e.handleInputChange(t)},className:"form-control mr-sm-2",type:"text",placeholder:"Rechercher...","aria-label":"Rechercher..."}),o.a.createElement(u.a,{icon:h.j,size:"2x"})),this.state.query.trim().length>0?o.a.createElement(j,{query:this.state.query,className:"d-none d-lg-block"}):null),o.a.createElement("ul",{className:"navbar-nav  mt-2 mt-lg-0"},n&&"admin"===r?o.a.createElement("li",{className:"nav-item"},o.a.createElement(m.c,{className:"nav-link",to:"/admin/home"},"Admin Dashboard")):null,n&&"supplier"===r&&s?o.a.createElement("li",{className:"nav-item"},o.a.createElement(m.c,{className:"nav-link",to:"/dashboard/reservations"},"Dashboard")):null,!n||"user"!==r&&"supplier"!==r?null:o.a.createElement("li",{className:"nav-item"},o.a.createElement(m.c,{className:"nav-link",to:"/user/reservations"},"Mes R\xe9servations")),!n||"user"!==r&&"supplier"!==r?null:o.a.createElement("li",{className:"nav-item"},o.a.createElement(m.c,{className:"nav-link",to:"/user/gallery"},"Ma Galerie")),n&&"admin"!==r?o.a.createElement("li",{className:"nav-item rec-item-desktop"},o.a.createElement("div",{className:"dropdown mt-2"},o.a.createElement("a",{href:"/recommandations",className:"",id:"dropdownMenuButton","data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false"},o.a.createElement(u.a,{icon:h.b,size:"1x"}),o.a.createElement("sup",{className:"ml-1"},c)),l.recommandations&&l.recommandations.length?o.a.createElement("div",{className:"dropdown-menu","aria-labelledby":"dropdownMenuButton"},o.a.createElement(b,{recommandations:l.recommandations.reverse()}),o.a.createElement("div",{className:"notifications-link py-2"},o.a.createElement(m.b,{id:"notifications-link",className:"notifications-link pt-3 text-center",to:"/user/notifications"},"Voir toutes les notifications"))):null)):null,n?null:o.a.createElement(w.a,null,o.a.createElement("li",{className:"nav-item"},o.a.createElement(m.c,{className:"nav-link",to:"/auth/signup"},o.a.createElement("i",{className:"fa fa-user"}),"Cr\xe9er un compte")),o.a.createElement("li",{className:"nav-item"},o.a.createElement(m.c,{className:"nav-link",to:"/auth/login"},o.a.createElement("i",{className:"fa fa-user"}),"Se connecter")))),n?o.a.createElement("div",{className:"dropdown"},o.a.createElement("p",{className:"dropbtn"},a),o.a.createElement("div",{className:"dropdown-content"},o.a.createElement(m.c,{className:"nav-link",to:"/user/profile"},o.a.createElement("i",{className:"fa fa-user"}),"Mon profil"),o.a.createElement("a",{href:"/auth/login",onClick:this.logout},o.a.createElement("i",{className:"fa fa-sign-out"}),"Logout"))):null))))}}]),t}(i.PureComponent);t.a=Object(d.b)(function(e){return{userId:e.auth.email,email:e.auth.email,name:e.auth.name,token:e.auth.token,role:e.auth.role,accountValidated:e.auth.accountValidated,user:e.auth.user}},function(e){return{onLogout:function(){return e(Object(p.e)())},onAutoSign:function(){return e(Object(p.a)())}}})(I)},119:function(e,t,a){},121:function(e,t,a){},122:function(e,t,a){},134:function(e,t){},201:function(e,t,a){"use strict";t.__esModule=!0,t.default=function(e,t){return e.classList?!!t&&e.classList.contains(t):-1!==(" "+(e.className.baseVal||e.className)+" ").indexOf(" "+t+" ")},e.exports=t.default},220:function(e,t,a){"use strict";var n=a(100);t.__esModule=!0,t.default=function(e,t){e.classList?e.classList.add(t):(0,r.default)(e,t)||("string"===typeof e.className?e.className=e.className+" "+t:e.setAttribute("class",(e.className&&e.className.baseVal||"")+" "+t))};var r=n(a(201));e.exports=t.default},221:function(e,t,a){"use strict";function n(e,t){return e.replace(new RegExp("(^|\\s)"+t+"(?:\\s|$)","g"),"$1").replace(/\s+/g," ").replace(/^\s*|\s*$/g,"")}e.exports=function(e,t){e.classList?e.classList.remove(t):"string"===typeof e.className?e.className=n(e.className,t):e.setAttribute("class",n(e.className&&e.className.baseVal||"",t))}},621:function(e,t,a){"use strict";a.r(t);var n=a(15),r=a(16),s=a(19),l=a(17),c=a(18),i=a(0),o=a.n(i),m=a(116),u=a(256),d=a.n(u),p=a(9),h=a.n(p),f=a(105),g=a(103),v=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(s.a)(this,Object(l.a)(t).call(this,e))).loadGallery=function(){var e=JSON.parse(localStorage.getItem("authData"));h.a.get("/api/user/"+e.user._id).then(function(e){var t=e.data.user.gallery.map(function(e,t){return{src:e,thumbnail:e,thumbnailWidth:320,thumbnailHeight:200}});t.reverse(),a.setState({images:t,loading:!1})}).catch(function(e){console.log(e),a.setState({images:[],loading:!1})})},a.onSelectImageToRemove=function(e,t){var n=a.state.images.slice(),r=n[e];r.hasOwnProperty("isSelected")?r.isSelected=!r.isSelected:r.isSelected=!0,a.setState({images:n},function(){a.state.images.filter(function(e){return!0===e.isSelected}).length?a.setState({isImageToDelete:!0}):a.setState({isImageToDelete:!1})})},a.deleteFromMyGallery=function(){var e=JSON.parse(localStorage.getItem("authData")).user._id;a.setState({deleting:!0});var t=a.state.images.filter(function(e){return!0!==e.isSelected}),n=t.map(function(e){return e.src});h.a.patch("/api/user/"+e+"/gallery/delete",{images:n}).then(function(e){a.setState({deleting:!1,images:t,isImageToDelete:!1})}).catch(function(e){a.setState({deleting:!1,isImageToDelete:!1})})},a.state={images:[],loading:!0,currentImage:0,isImageToDelete:!1,deleting:!1},a}return Object(c.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){this.loadGallery()}},{key:"componentDidUpdate",value:function(e){e!==this.props&&this.loadGallery()}},{key:"render",value:function(){return o.a.createElement(g.a,null,o.a.createElement(m.a,null),o.a.createElement("section",null,o.a.createElement("div",{className:"container py-5 mt-5"},o.a.createElement("div",{className:"row py-5",style:{backgroundColor:"white"}},o.a.createElement("div",{className:"col-sm-12 p-5"},o.a.createElement("h2",{className:"text-center display-5"},"MA GALERIE")),o.a.createElement("div",{className:"col-sm-12 px-5 pt-0 pb-5 mb-5"},this.state.loading?o.a.createElement("div",{className:"d-flex justify-content-center"},o.a.createElement(f.a,null)):this.state.images.length>0?o.a.createElement(g.a,null,this.state.isImageToDelete?this.state.deleting?o.a.createElement("div",{className:"d-flex justify-content-center"},o.a.createElement(f.a,null)):o.a.createElement("div",{className:"d-flex justify-content-center"},o.a.createElement("button",{onClick:this.deleteFromMyGallery,className:"btn btn-danger my-3"},"Supprimer")):null,o.a.createElement(d.a,{enableLightbox:!0,enableImageSelection:!0,onSelectImage:this.onSelectImageToRemove,images:this.state.images,currentImageWillChange:this.onCurrentImageChange})):o.a.createElement("div",{className:"d-flex justify-content-center py-5"},o.a.createElement("h4",null,"Aucune image dans votre galerie.")))))))}}]),t}(i.Component);t.default=v}}]);
//# sourceMappingURL=24.b96b3514.chunk.js.map